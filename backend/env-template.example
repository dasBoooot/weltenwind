# ===========================================
# üåê WELTENWIND BACKEND CONFIGURATION
# ===========================================

# ===========================================
# üåê URL CONFIGURATION (SSL-Ready)
# ===========================================
NODE_ENV=development

# ===========================================
# üìù LOGGING CONFIGURATION
# ===========================================
# Log-Level: error, warn, info, debug
LOG_LEVEL=debug

# Log-Ausgabe steuern
LOG_TO_FILE=true
LOG_TO_CONSOLE=true

# Log-Verzeichnis (Linux/Production)
LOG_DIR=/var/log/weltenwind

# Backend Internal URLs (f√ºr Logs, Health-Checks, interne Calls)
BASE_URL="http://localhost:3000"
PORT=3000

# Public/External URLs (f√ºr Clients √ºber nginx Reverse Proxy)
PUBLIC_API_URL="https://192.168.2.168/api"           # API-Zugriffe √ºber nginx
PUBLIC_CLIENT_URL="https://192.168.2.168"            # Client/Game-URL f√ºr Invite-Links
PUBLIC_ASSETS_URL="https://192.168.2.168"            # Static Assets (theme-editor, arb-manager, etc.)

# CORS Origins (Development - beide HTTP/HTTPS erlauben)
ALLOWED_ORIGINS="https://192.168.2.168,http://localhost:8080,https://localhost:8080"

# CSRF-Token-Konfiguration
CSRF_TOKEN_EXPIRY_HOURS=1                 # CSRF-Token-Lebensdauer in Stunden

# Erweiterte CSRF-Sicherheitsfeatures (optional)
ENABLE_DOUBLE_SUBMIT_COOKIE=false         # Double-Submit-Cookie-Pattern aktivieren
ENABLE_ORIGIN_VALIDATION=true             # Origin-Header-Validierung
ENABLE_REFERER_VALIDATION=false           # Referer-Header-Validierung (kann problematisch sein)
ENABLE_USER_AGENT_BINDING=false           # CSRF-Token an User-Agent binden

# Trusted Origins f√ºr CORS/CSRF (komma-separiert)
TRUSTED_ORIGINS="https://192.168.2.168,http://localhost:8080,https://localhost:8080"

# ===========================================
# üîê SSL & SECURITY
# ===========================================
SSL_ENABLED=true                          # Aktiviert SSL-Unterst√ºtzung
TRUST_PROXY=true                          # Nginx Reverse Proxy Trust (nur 1 Hop = SICHER)

# ===========================================
# üîê JWT CONFIGURATION
# ===========================================
JWT_SECRET="your-super-secret-jwt-key-here-min-32-chars"
JWT_EXPIRES_IN=15m                        # Access Token Expiry
JWT_REFRESH_EXPIRES_IN=7d                 # Refresh Token Expiry

# ===========================================
# üíæ DATABASE CONFIGURATION
# ===========================================
DATABASE_URL="postgresql://username:password@localhost:5432/weltenwind"
SHADOW_DATABASE_URL="postgresql://username:password@localhost:5432/weltenwind_shadow"

# ===========================================
# üìß EMAIL CONFIGURATION
# ===========================================
SMTP_HOST=""
SMTP_PORT=""
SMTP_USER=""
SMTP_PASS=""
SMTP_FROM=""

# OAuth2 Settings (f√ºr Gmail etc.)
OAUTH_CLIENT_ID=""
OAUTH_CLIENT_SECRET=""
OAUTH_REFRESH_TOKEN=""

# ===========================================
# üõ°Ô∏è SESSION & SECURITY
# ===========================================
SESSION_SECRET="your-session-secret-here-min-32-chars"
ALLOW_MULTI_DEVICE_LOGIN=false
MAX_SESSIONS_PER_USER=1

# Session-Limits und Timeouts
MAX_CONCURRENT_SESSIONS=3                  # Max gleichzeitige Sessions pro User
SESSION_INACTIVITY_TIMEOUT_HOURS=24       # Inaktive Sessions l√∂schen nach X Stunden
ALLOW_MULTI_DEVICE_LOGIN=false            # Multi-Device-Login erlauben
MAX_SESSIONS_PER_USER=1                   # Max Sessions pro User (wenn Multi-Device aktiv)

# Security-Monitoring
SUSPICIOUS_ACTIVITY_THRESHOLD=5           # Verd√§chtig ab X verschiedenen IPs
ENABLE_LOCATION_TRACKING=false            # IP-Geolocation-basierte Validierung

# Account-Lockout (Brute-Force-Protection)
MAX_LOGIN_ATTEMPTS=5                      # Max fehlgeschlagene Login-Versuche
LOCKOUT_DURATION_MINUTES=15               # Lockout-Dauer nach zu vielen Fehlversuchen

# Brute Force Protection
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=15

# ‚ö° Rate Limiting (Development-friendly defaults)
AUTH_RATE_LIMIT_WINDOW_MINUTES=5       # Login/Register: 5 Min Window
AUTH_RATE_LIMIT_MAX_REQUESTS=20        # Login/Register: Max 20 Requests
AUTH_SLOWDOWN_WINDOW_MINUTES=15        # Login SlowDown: 15 Min Window
API_RATE_LIMIT_WINDOW_MINUTES=1        # General API: 1 Min Window
API_RATE_LIMIT_MAX_REQUESTS=100        # General API: Max 100 Requests
PASSWORD_RESET_WINDOW_HOURS=1          # Password Reset: 1 Hour Window
PASSWORD_RESET_MAX_REQUESTS=3          # Password Reset: Max 3 Requests
REGISTRATION_LIMIT_WINDOW_HOURS=24     # Registration: 24 Hours Window
REGISTRATION_LIMIT_MAX_REQUESTS=5      # Registration: Max 5 per IP

# √ñffentliche Endpoints (sehr streng - Spam-Schutz)
PUBLIC_ENDPOINT_WINDOW_MINUTES=60          # Zeitfenster f√ºr √∂ffentliche APIs
PUBLIC_ENDPOINT_MAX_REQUESTS=10            # Max Requests pro IP/Zeitfenster

# Invite-Operationen (Spam-Schutz f√ºr Invite-System)
INVITE_CREATION_WINDOW_MINUTES=10          # Zeitfenster f√ºr Invite-Ops
INVITE_CREATION_MAX_REQUESTS=20            # Max Invite-Ops pro Zeitfenster

# Admin-Endpoints (moderat - f√ºr Log-Viewer etc.)
ADMIN_ENDPOINT_WINDOW_MINUTES=5            # Zeitfenster f√ºr Admin-APIs
ADMIN_ENDPOINT_MAX_REQUESTS=200            # Max Admin-Requests pro Zeitfenster

# World-Operationen (f√ºr Game-bezogene APIs)
WORLD_OPERATIONS_WINDOW_MINUTES=15         # Zeitfenster f√ºr World-Ops
WORLD_OPERATIONS_MAX_REQUESTS=30           # Max World-Ops pro Zeitfenster

# üõ°Ô∏è CSRF Protection (f√ºr SSL-Migration optimiert)
CSRF_AUTO_RECOVERY=true                   # Development: Auto-Recovery bei ung√ºltigen Tokens

# ===========================================
# üßπ CLEANUP & MAINTENANCE
# ===========================================
SESSION_CLEANUP_INTERVAL_MINUTES=5
AUTO_CLEANUP_EXPIRED_SESSIONS=true

# ===========================================
# üìä LOGGING & MONITORING
# ===========================================
LOG_LEVEL=info                            # debug, info, warn, error
LOG_FILE_MAX_SIZE="10m"                   # Log file size (k/m/g suffix)
LOG_FILE_MAX_FILES=5                      # Max log files to keep
ERROR_LOG_MAX_FILES=10                    # Max error log files

# ===========================================
# üéÆ GAME & FEATURES
# ===========================================
MAX_WORLDS_PER_USER=5
INVITE_EXPIRY_DAYS=7
THEME_CACHE_TTL_MINUTES=30

# ===========================================
# üöß DEVELOPMENT SETTINGS
# ===========================================
DEBUG_SQL=false
DEBUG_AUTH=false
ENABLE_SWAGGER=true

# =====================================================
# üóÑÔ∏è BACKUP-SYSTEM KONFIGURATION
# =====================================================

# Backup-System aktivieren/deaktivieren
BACKUP_ENABLED=true

# Backup-Verzeichnis (absoluter Pfad auf dem Server)
BACKUP_DIR="/srv/weltenwind/backups"

# Backup-Retention (Aufbewahrungszeiten)
BACKUP_RETENTION_DAILY_DAYS=7          # T√§gliche Backups aufbewahren (Tage)
BACKUP_RETENTION_WEEKLY_WEEKS=4        # W√∂chentliche Backups aufbewahren (Wochen)
BACKUP_RETENTION_MONTHLY_MONTHS=12     # Monatliche Backups aufbewahren (Monate)

# Backup-Timing (Cron-Expressions)
BACKUP_SCHEDULE_DAILY="0 2 * * *"      # T√§glich um 2:00 Uhr
BACKUP_SCHEDULE_WEEKLY="0 1 * * 0"     # Sonntags um 1:00 Uhr
BACKUP_SCHEDULE_MONTHLY="0 0 1 * *"    # Ersten des Monats um 0:00 Uhr

# Backup-Komprimierung
BACKUP_COMPRESSION_ENABLED=true        # gzip-Komprimierung aktivieren
BACKUP_COMPRESSION_LEVEL=6             # Komprimierungsgrad (1-9, 6=Standard)

# Backup-Parallel-Jobs (f√ºr gro√üe Datenbanken)
BACKUP_PARALLEL_JOBS=2                 # Anzahl paralleler pg_dump Jobs

# Adaptive Backup-Features
BACKUP_AUTO_DISCOVERY=true             # Automatische Table-Erkennung
BACKUP_SMART_SCHEDULING=true           # Intelligente Schedule-Anpassung
BACKUP_SIZE_OPTIMIZATION=true          # Gr√∂√üenbasierte Optimierung

# Backup-Monitoring
BACKUP_HEALTH_CHECK_ENABLED=true       # Backup-Health-Checks aktivieren
BACKUP_NOTIFICATION_ENABLED=false      # E-Mail-Benachrichtigungen (TODO: Mail-Setup erforderlich)
BACKUP_NOTIFICATION_EMAIL=""           # E-Mail f√ºr Backup-Alerts

# Backup-Recovery Testing
BACKUP_AUTO_VERIFICATION=true          # Automatische Backup-Verifikation
BACKUP_RECOVERY_TEST_ENABLED=false     # Recovery-Tests (vorsichtig verwenden!)

# Offsite-Backup (f√ºr Production)
BACKUP_OFFSITE_ENABLED=false           # Remote-Backup aktivieren
BACKUP_S3_BUCKET=""                    # S3-Bucket f√ºr Offsite-Backup
BACKUP_S3_REGION="eu-central-1"        # AWS Region
BACKUP_S3_ACCESS_KEY=""                # AWS Access Key
BACKUP_S3_SECRET_KEY=""                # AWS Secret Key

# Backup-Performance Limits
BACKUP_MAX_FILE_SIZE_MB=1000           # Max. Backup-Dateigr√∂√üe (MB)
BACKUP_IO_NICE_LEVEL=3                 # IO-Priorit√§t (0-7, 3=niedrig)
BACKUP_CPU_NICE_LEVEL=10               # CPU-Priorit√§t (0-20, 10=niedrig)

# Debug & Logging
BACKUP_DEBUG_MODE=false                # Ausf√ºhrliches Backup-Logging
BACKUP_LOG_RETENTION_DAYS=30           # Backup-Logs aufbewahren (Tage)

#