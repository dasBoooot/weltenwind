<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weltenwind Theme Editor</title>
    <link rel="stylesheet" href="theme-editor.css">
</head>
<body>
    <!-- Login Form -->
    <div id="loginContainer" class="login-container">
        <h1>🎨 Weltenwind Theme Editor</h1>
        <p>Admin-Login erforderlich</p>
        <div id="loginError" class="error hidden"></div>
        <form id="loginForm">
            <div>
                <input type="text" id="username" placeholder="Username oder E-Mail" required>
            </div>
            <div>
                <input type="password" id="password" placeholder="Password" required>
            </div>
            <div>
                <button type="submit" id="loginButton">🔓 Anmelden</button>
            </div>
        </form>
    </div>

    <!-- Theme Editor (hidden initially) -->
    <div id="themeEditor" class="hidden">
        <h1>🎨 Weltenwind Theme Editor</h1>
        <div style="float: right;">
            <span id="userInfo"></span>
            <button onclick="logout()">🚪 Abmelden</button>
        </div>

        <div class="theme-info">
            <h3 id="currentThemeTitle">🎭 Aktuelles Theme</h3>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="themeName">-</div>
                    <div class="stat-label">Theme</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="themeVersion">-</div>
                    <div class="stat-label">Version</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="colorCount">-</div>
                    <div class="stat-label">Farben</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="toolbar">
                <div class="theme-selector">
                    <select id="themeSelector" onchange="loadSelectedTheme()">
                        <option value="">🎨 Theme wählen...</option>
                    </select>
                    <button class="btn-secondary" onclick="showCloneDialog()" id="cloneButton" disabled>📋 Klonen</button>
                </div>
                <div class="actions">
                    <button class="btn-success" onclick="showSaveConfirmDialog()" id="saveButton" disabled>💾 Speichern</button>
                    <button class="btn-secondary" onclick="showExportDialog()" id="exportButton" disabled>📤 Export JSON</button>
                    <button class="btn-secondary" onclick="resetTheme()" id="resetButton" disabled>🔄 Zurücksetzen</button>
                    <button onclick="togglePreview()" id="previewButton" disabled>👀 Live-Preview</button>
                </div>
            </div>
        </div>

        <!-- Main Editor Layout -->
        <div class="editor-layout">
            <!-- Color Editor Panel -->
            <div class="editor-panel">
                <h3>🎨 Farben bearbeiten</h3>
                <div id="colorEditor" class="color-editor">
                    <div class="loading">
                        <div class="spinner"></div>
                        <div>Theme laden...</div>
                    </div>
                </div>
            </div>

            <!-- Live Preview Panel -->
            <div class="preview-panel" id="previewPanel">
                <h3>👀 Live-Preview</h3>
                <div class="preview-container">
                    <div class="preview-components">
                        <!-- Login Card Preview -->
                        <div class="preview-card" id="loginCardPreview">
                            <h4>Login Card</h4>
                            <div class="preview-login">
                                <input type="text" placeholder="Username" readonly>
                                <input type="password" placeholder="Password" readonly>
                                <button class="preview-btn preview-primary">Anmelden</button>
                            </div>
                        </div>

                        <!-- Button Preview -->
                        <div class="preview-card" id="buttonPreview">
                            <h4>Buttons</h4>
                            <div class="preview-buttons">
                                <button class="preview-btn preview-primary">Primary</button>
                                <button class="preview-btn preview-secondary">Secondary</button>
                                <button class="preview-btn preview-success">Success</button>
                                <button class="preview-btn preview-danger">Error</button>
                            </div>
                        </div>

                        <!-- Card Preview -->
                        <div class="preview-card" id="cardPreview">
                            <h4>Cards & Surfaces</h4>
                            <div class="preview-surface">
                                <p>Surface Dark</p>
                            </div>
                            <div class="preview-surface-light">
                                <p>Surface Light</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="themeMessage" class="hidden"></div>
    </div>

    <!-- Clone Dialog -->
    <div id="cloneDialog" class="hidden">
        <div class="dialog-overlay">
            <div class="dialog-content">
                <h3>📋 Theme klonen</h3>
                <p>Erstelle eine Kopie von <strong id="cloneSourceName">-</strong>:</p>
                
                <div class="clone-form">
                    <div>
                        <label for="cloneNewName">Neuer Name:</label>
                        <input type="text" id="cloneNewName" placeholder="z.B. 'Mein Custom Theme'">
                    </div>
                    <div>
                        <label for="cloneNewDescription">Beschreibung:</label>
                        <textarea id="cloneNewDescription" placeholder="Beschreibung des neuen Themes..."></textarea>
                    </div>
                </div>
                
                <div class="dialog-buttons">
                    <button class="btn-secondary" onclick="closeCloneDialog()">❌ Abbrechen</button>
                    <button class="btn-success" onclick="confirmClone()" id="confirmCloneButton">📋 Klonen</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Dialog -->
    <div id="exportDialog" class="hidden">
        <div class="dialog-overlay">
            <div class="dialog-content">
                <h3>📤 Theme exportieren</h3>
                <p>Theme als JSON-Datei herunterladen:</p>
                
                <div class="export-info">
                    <strong>Exportiert werden:</strong>
                    <ul>
                        <li>Alle Farbdefinitionen</li>
                        <li>Spacing & Radius Werte</li>
                        <li>Typografie-Einstellungen</li>
                        <li>Schatten-Definitionen</li>
                        <li>Theme-Metadaten</li>
                    </ul>
                </div>
                
                <div class="dialog-buttons">
                    <button class="btn-secondary" onclick="closeExportDialog()">❌ Abbrechen</button>
                    <button class="btn-success" onclick="exportTheme()">📤 JSON Download</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Save Confirmation Dialog -->
    <div id="saveConfirmDialog" class="hidden">
        <div class="dialog-overlay">
            <div class="dialog-content">
                <h3>💾 Theme speichern</h3>
                <p><strong>🎨 Theme:</strong> <span id="saveThemeDisplay">-</span></p>
                <p><strong>⚠️ Wichtiger Hinweis:</strong></p>
                
                <div class="save-warning">
                    <ul>
                        <li>🎨 Das <strong>aktuelle Theme</strong> wird überschrieben</li>
                        <li>💾 Alle Änderungen werden permanent gespeichert</li>
                        <li>🔄 Ein Backup wird automatisch erstellt</li>
                        <li>✅ Das Theme wird für die Flutter-App verfügbar</li>
                    </ul>
                </div>
                
                <div class="save-next-steps">
                    <strong>Nach dem Speichern:</strong>
                    <ol>
                        <li>🔄 Lade die Seite neu um die Änderungen zu sehen</li>
                        <li>🎮 Teste das Theme in der Flutter-App</li>
                        <li>📱 Überprüfe die Darstellung auf verschiedenen Geräten</li>
                    </ol>
                </div>
                
                <div class="dialog-buttons">
                    <button class="btn-secondary" onclick="closeSaveConfirmDialog()">❌ Abbrechen</button>
                    <button class="btn-success" onclick="confirmSave()">✅ Jetzt speichern</button>
                </div>
            </div>
        </div>
    </div>

    <script src="theme-editor.js"></script>
</body>
</html>