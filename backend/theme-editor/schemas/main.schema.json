{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://weltenwind.game/schemas/main.schema.json",
  "title": "Weltenwind Modular Theme Schema",
  "description": "Master schema that orchestrates all theme modules with $refs for maximum flexibility",
  "type": "object",
  "required": ["name", "version", "colors"],
  "definitions": {
    "bundleConfig": {
      "type": "object",
      "description": "Bundle configuration for selective module loading",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["minimal", "basic", "gaming", "complete"],
          "default": "complete",
          "description": "Bundle type determines which modules are included"
        },
        "modules": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["colors", "typography", "spacing", "radius", "components", "gaming", "effects", "accessibility"]
          },
          "description": "Explicitly enabled modules (overrides bundle type)"
        },
        "context": {
          "type": "string",
          "enum": ["pre-game", "world-preview", "in-game", "universal"],
          "default": "universal",
          "description": "Usage context for conditional loading"
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Theme metadata and compatibility information",
      "properties": {
        "author": {
          "type": "string",
          "description": "Theme author name"
        },
        "category": {
          "type": "string",
          "enum": ["fantasy", "sci-fi", "modern", "classic", "custom"],
          "default": "fantasy",
          "description": "Theme category"
        },
        "tags": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Searchable theme tags"
        },
        "targetWorlds": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Compatible world types"
        },
        "compatibility": {
          "type": "object",
          "properties": {
            "minVersion": {
              "type": "string",
              "description": "Minimum game version"
            },
            "maxVersion": {
              "type": "string",
              "description": "Maximum game version"
            },
            "features": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Required game features"
            }
          }
        }
      }
    }
  },
  "properties": {
    "$schema": {
      "type": "string",
      "description": "Schema reference"
    },
    "name": {
      "type": "string",
      "description": "Theme display name",
      "minLength": 1,
      "maxLength": 50
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version number (e.g., 1.0.0)"
    },
    "description": {
      "type": "string",
      "description": "Theme description",
      "maxLength": 200
    },
    "bundle": {
      "$ref": "#/definitions/bundleConfig",
      "description": "Bundle configuration for selective loading"
    },
    "metadata": {
      "$ref": "#/definitions/metadata",
      "description": "Theme metadata and compatibility"
    },
    "colors": {
      "$ref": "https://weltenwind.game/schemas/core/colors.schema.json",
      "description": "Complete color palette with UI and gaming colors"
    },
    "typography": {
      "type": "object",
      "description": "Typography system with font families and text styles",
      "required": ["heading", "body", "caption"],
      "properties": {
        "fontFamily": {
          "type": "object",
          "description": "Font family definitions",
          "required": ["primary"],
          "properties": {
            "primary": {
              "type": "string",
              "default": "Inter",
              "description": "Primary font family for UI"
            },
            "secondary": {
              "type": "string", 
              "default": "Poppins",
              "description": "Secondary font family for headings"
            },
            "body": {
              "type": "string",
              "default": "Inter",
              "description": "Body text font family"
            },
            "monospace": {
              "type": "string",
              "default": "JetBrains Mono",
              "description": "Monospace font for code/data"
            }
          }
        },
        "heading": {
          "type": "object",
          "required": ["fontSize", "fontWeight"],
          "properties": {
            "fontSize": { "type": "number", "minimum": 16, "maximum": 48, "default": 24 },
            "fontWeight": { "type": "string", "enum": ["normal", "bold", "100", "200", "300", "400", "500", "600", "700", "800", "900"], "default": "bold" },
            "letterSpacing": { "type": "number", "default": -0.3 },
            "lineHeight": { "type": "number", "minimum": 0.8, "maximum": 2.0, "default": 1.2 },
            "fontFamily": { "type": "string", "description": "Override font family for headings" }
          }
        },
        "body": {
          "type": "object",
          "required": ["fontSize", "fontWeight"],
          "properties": {
            "fontSize": { "type": "number", "minimum": 12, "maximum": 24, "default": 16 },
            "fontWeight": { "type": "string", "enum": ["normal", "bold", "100", "200", "300", "400", "500", "600", "700", "800", "900"], "default": "normal" },
            "letterSpacing": { "type": "number", "default": 0 },
            "lineHeight": { "type": "number", "minimum": 1.0, "maximum": 2.0, "default": 1.4 },
            "fontFamily": { "type": "string", "description": "Override font family for body text" }
          }
        },
        "caption": {
          "type": "object",
          "required": ["fontSize", "fontWeight"],
          "properties": {
            "fontSize": { "type": "number", "minimum": 10, "maximum": 16, "default": 12 },
            "fontWeight": { "type": "string", "enum": ["normal", "bold", "100", "200", "300", "400", "500", "600", "700", "800", "900"], "default": "500" },
            "letterSpacing": { "type": "number", "default": 0.4 },
            "lineHeight": { "type": "number", "minimum": 1.0, "maximum": 2.0, "default": 1.3 },
            "fontFamily": { "type": "string", "description": "Override font family for captions" }
          }
        }
      }
    },
    "radius": {
      "type": "object",
      "description": "Border radius values for consistent rounding",
      "required": ["small", "medium", "large"],
      "properties": {
        "small": { "type": "number", "minimum": 0, "maximum": 20, "default": 4 },
        "medium": { "type": "number", "minimum": 0, "maximum": 30, "default": 8 },
        "large": { "type": "number", "minimum": 0, "maximum": 50, "default": 16 },
        "extraLarge": { "type": "number", "minimum": 0, "maximum": 100, "default": 24 },
        "circle": { "type": "number", "minimum": 50, "maximum": 100, "default": 50 }
      }
    },
    "spacing": {
      "type": "object",
      "description": "Spacing scale for consistent layout",
      "required": ["xs", "sm", "md", "lg", "xl"],
      "properties": {
        "xs": { "type": "number", "minimum": 0, "maximum": 16, "default": 4 },
        "sm": { "type": "number", "minimum": 0, "maximum": 24, "default": 8 },
        "md": { "type": "number", "minimum": 0, "maximum": 32, "default": 16 },
        "lg": { "type": "number", "minimum": 0, "maximum": 48, "default": 24 },
        "xl": { "type": "number", "minimum": 0, "maximum": 64, "default": 32 },
        "xxl": { "type": "number", "minimum": 0, "maximum": 96, "default": 48 }
      }
    },
    "components": {
      "type": "object",
      "description": "UI component configurations",
      "properties": {
        "appBar": {
          "type": "object",
          "properties": {
            "elevation": { "type": "number", "minimum": 0, "default": 0 },
            "centerTitle": { "type": "boolean", "default": true },
            "shadowColor": { "type": "string", "default": "transparent" },
            "surfaceTintColor": { "type": "string", "default": "transparent" },
            "systemOverlayStyle": { "type": "string", "enum": ["light", "dark"], "default": "dark" }
          }
        },
        "card": {
          "type": "object",
          "properties": {
            "elevation": { "type": "number", "minimum": 0, "default": 0 },
            "shadowColor": { "type": "string" },
            "borderRadius": { "type": "number", "minimum": 0, "default": 16 },
            "clipBehavior": { "type": "string", "enum": ["none", "antiAlias", "hardEdge"], "default": "antiAlias" },
            "margin": { "type": "number", "minimum": 0, "default": 4 }
          }
        },
        "buttons": {
          "type": "object",
          "properties": {
            "elevation": { "type": "number", "minimum": 0, "default": 0 },
            "shadowColor": { "type": "string", "default": "transparent" },
            "borderRadius": { "type": "number", "minimum": 0, "default": 12 },
            "paddingHorizontal": { "type": "number", "minimum": 0, "default": 24 },
            "paddingVertical": { "type": "number", "minimum": 0, "default": 16 },
            "borderWidth": { "type": "number", "minimum": 0, "default": 1.5 }
          }
        },
        "inputs": {
          "type": "object",
          "properties": {
            "filled": { "type": "boolean", "default": true },
            "borderRadius": { "type": "number", "minimum": 0, "default": 12 },
            "borderWidth": { "type": "number", "minimum": 0, "default": 1 },
            "focusedBorderWidth": { "type": "number", "minimum": 0, "default": 2 },
            "paddingHorizontal": { "type": "number", "minimum": 0, "default": 16 },
            "paddingVertical": { "type": "number", "minimum": 0, "default": 16 }
          }
        }
      }
    },
    "gaming": {
      "type": "object",
      "description": "Gaming-specific theme modules",
      "properties": {
        "inventory": {
          "$ref": "https://weltenwind.game/schemas/gaming/inventory.schema.json",
          "description": "RPG inventory system with slots, rarity, and interactions"
        },
        "progress": {
          "$ref": "https://weltenwind.game/schemas/gaming/progress.schema.json", 
          "description": "Progress bars for health, mana, XP with animations"
        },
        "hud": {
          "$ref": "https://weltenwind.game/schemas/gaming/hud.schema.json",
          "description": "In-game HUD with minimap, buffs, resources, notifications"
        }
      }
    },
    "responsive": {
      "type": "object",
      "description": "Responsive design configuration",
      "properties": {
        "breakpoints": {
          "type": "object",
          "description": "Screen size breakpoints",
          "properties": {
            "mobile": { "type": "number", "minimum": 0, "default": 576, "description": "Mobile breakpoint in pixels" },
            "tablet": { "type": "number", "minimum": 577, "default": 768, "description": "Tablet breakpoint in pixels" },
            "desktop": { "type": "number", "minimum": 769, "default": 1024, "description": "Desktop breakpoint in pixels" },
            "wide": { "type": "number", "minimum": 1025, "default": 1440, "description": "Wide screen breakpoint in pixels" }
          }
        },
        "scaleFactor": {
          "type": "object",
          "description": "Scaling factors for different screen sizes",
          "properties": {
            "mobile": { "type": "number", "minimum": 0.5, "maximum": 2.0, "default": 0.85 },
            "tablet": { "type": "number", "minimum": 0.5, "maximum": 2.0, "default": 0.95 },
            "desktop": { "type": "number", "minimum": 0.5, "maximum": 2.0, "default": 1.0 },
            "wide": { "type": "number", "minimum": 0.5, "maximum": 2.0, "default": 1.1 }
          }
        },
        "adaptiveSpacing": {
          "type": "boolean",
          "default": true,
          "description": "Automatic spacing adaptation based on screen size"
        },
        "adaptiveTypography": {
          "type": "boolean",
          "default": true,
          "description": "Automatic typography scaling based on screen size"
        }
      }
    },
    "shadows": {
      "type": "object",
      "description": "Shadow definitions for depth",
      "properties": {
        "small": {
          "type": "object",
          "required": ["blurRadius", "spreadRadius", "offset", "color"],
          "properties": {
            "blurRadius": { "type": "number", "minimum": 0, "default": 2 },
            "spreadRadius": { "type": "number", "default": 0 },
            "offset": { "type": "array", "items": { "type": "number" }, "minItems": 2, "maxItems": 2, "default": [0, 1] },
            "color": { "type": "string", "pattern": "^#[0-9A-Fa-f]{8}$", "default": "#00000020" }
          }
        },
        "medium": {
          "type": "object",
          "required": ["blurRadius", "spreadRadius", "offset", "color"],
          "properties": {
            "blurRadius": { "type": "number", "minimum": 0, "default": 4 },
            "spreadRadius": { "type": "number", "default": 0 },
            "offset": { "type": "array", "items": { "type": "number" }, "minItems": 2, "maxItems": 2, "default": [0, 2] },
            "color": { "type": "string", "pattern": "^#[0-9A-Fa-f]{8}$", "default": "#00000030" }
          }
        },
        "large": {
          "type": "object",
          "required": ["blurRadius", "spreadRadius", "offset", "color"],
          "properties": {
            "blurRadius": { "type": "number", "minimum": 0, "default": 8 },
            "spreadRadius": { "type": "number", "default": 0 },
            "offset": { "type": "array", "items": { "type": "number" }, "minItems": 2, "maxItems": 2, "default": [0, 4] },
            "color": { "type": "string", "pattern": "^#[0-9A-Fa-f]{8}$", "default": "#00000040" }
          }
        }
      }
    },
    "conditions": {
      "type": "object",
      "description": "Conditional theme activation based on game state",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false,
          "description": "Enable conditional theme system"
        },
        "rules": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["condition", "modules"],
            "properties": {
              "condition": {
                "type": "object",
                "description": "Condition for theme activation",
                "properties": {
                  "playerLevel": { "type": "number", "minimum": 1 },
                  "worldType": { "type": "string" },
                  "timeOfDay": { "type": "string", "enum": ["day", "night", "dawn", "dusk"] },
                  "weather": { "type": "string", "enum": ["sunny", "rain", "storm", "snow"] },
                  "inBattle": { "type": "boolean" },
                  "bossActive": { "type": "boolean" },
                  "deviceTier": { "type": "string", "enum": ["low", "medium", "high"] }
                }
              },
              "modules": {
                "type": "object",
                "description": "Module overrides for this condition",
                "additionalProperties": true
              }
            }
          }
        }
      }
    },
    "extensions": {
      "type": "object",
      "description": "Fantasy theme extensions for magical effects",
      "properties": {
        "magicGradient": {
          "type": "array",
          "items": { "type": "string", "pattern": "^#[0-9A-Fa-f]{6}$" },
          "minItems": 2,
          "maxItems": 5,
          "default": ["#7C6BAF", "#A594D1"],
          "description": "Magic gradient colors"
        },
        "portalGradient": {
          "type": "array",
          "items": { "type": "string", "pattern": "^#[0-9A-Fa-f]{6}$" },
          "minItems": 2,
          "maxItems": 5,
          "default": ["#4A90E2", "#7C6BAF"],
          "description": "Portal gradient colors"
        },
        "parallaxStrength": {
          "type": "number",
          "minimum": 0,
          "maximum": 1.0,
          "default": 0.3,
          "description": "Parallax scrolling intensity"
        },
        "hoverAuraColor": {
          "type": "string",
          "pattern": "^#[0-9A-Fa-f]{6}$",
          "default": "#A594D1",
          "description": "Hover aura effect color"
        },
        "depthBlur": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "intensity": { "type": "number", "minimum": 0, "maximum": 10, "default": 2 },
            "focusDistance": { "type": "number", "minimum": 0, "maximum": 100, "default": 50 }
          }
        },
        "particles": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "density": { "type": "number", "minimum": 0.1, "maximum": 2.0, "default": 0.5 },
            "color": { "type": "string", "pattern": "^#[0-9A-Fa-f]{6}$", "default": "#A594D1" }
          }
        },
        "screenEffects": {
          "type": "object",
          "properties": {
            "vignette": { "type": "number", "minimum": 0, "maximum": 1.0, "default": 0.2 },
            "bloom": { "type": "number", "minimum": 0, "maximum": 1.0, "default": 0.1 },
            "colorGrading": { "type": "string", "enum": ["none", "warm", "cool", "fantasy"], "default": "fantasy" },
            "weather": { "type": "string", "enum": ["none", "rain", "snow", "fog"], "default": "none" }
          }
        }
      }
    }
  },
  "examples": [
    {
      "name": "Mystical Fantasy",
      "version": "1.0.0",
      "description": "A mystical fantasy theme with glowing effects",
      "bundle": {
        "type": "gaming",
        "context": "in-game"
      },
      "metadata": {
        "author": "Weltenwind Team",
        "category": "fantasy",
        "tags": ["mystical", "purple", "glow"],
        "targetWorlds": ["fantasy", "magic"]
      },
      "colors": {
        "$ref": "https://weltenwind.game/schemas/core/colors.schema.json"
      },
      "gaming": {
        "inventory": {
          "$ref": "https://weltenwind.game/schemas/gaming/inventory.schema.json"
        },
        "progress": {
          "$ref": "https://weltenwind.game/schemas/gaming/progress.schema.json"
        },
        "hud": {
          "$ref": "https://weltenwind.game/schemas/gaming/hud.schema.json"
        }
      }
    }
  ],
  "additionalProperties": false
}